Прерывания. Основные характеристики ЭВМ, связанные с прерываниями
=========================================================
1. **Число источников запросов прерываний.**
2. **Глубина прерывания.** Максимальное число программ, которые могут прерывать друг друга(*Максимальное количество вызовов прерываний из других прерываний*).
3. **Время реакции на запрос прерывания [t_р].** Время между появлением запроса и началом выполнения прерывающей программы. *Определяется для запросов с наивысшим приоритетом.*
4. **Затраты времени на переключение программы.** Складывается из времени запоминания контекста прерванной программы [t_з] и времени восстановления этого контекста [t_в].

(рис. 1)[]

Число прерываний может составлять несколько сотен, а число обработчиков прерываний обычно гораздо меньше. С точки зрения экономии аппаратуры, удобно будет объединить все сигналы, инициирующие выполнение одного и того же обработчика. Совокупность запросов к одной прерывающей программе образует **класс прерывания**. Схема разделения запроов прерывания на классы имеет следующий вид:

(рис. 2)[]

Активные сигналы запросов от источников прерываний (I) устанавливают в единицу флаги *регистров запросов прерываний* РгЗП, каждый разряд которого связан с определённым источником прерываний. Если несколько запросов связаны с одним обработчиком, то соответствующие разряда объединяются i-ым дизъюнктором, на выходе которого возникает запрос i-го класса прерываний ЗпКПi. Все ЗпКП i-ые поступают на общий дизъюнктор, генерирую *общий сигнал прерывания* ОСП. Для того, чтобы идентифицировать, какой класс прерываний активен, используется *схема определения класса прерывания* СОКП, которая даёт на выходе сигнал *класса прерывающего запроса* КПЗ. 

Приоритеты запросов прерывания.
===============================
Приоритеты запросов прерывания могут быть жёстко заданы, а могут изменяться в процессе функционирования ЭВМ. Фиксированный характер имеет приоритетная система, основанная на опросе флагов. В этом случае определяется положение крайней левой единицы в РгЗП. Данный процесс производится путём опроса разрядов. Разряд, в котором зафиксирована крайняя левая единица является наиболее приоритетным. Далее приоритеты распределяются в порядке движения по РгЗП слева направо. Таким образом, приоритет источников запросов прерываний жёстко определяется номером разряда в РгЗп, к которому он присоединён. Программно-управляемый приоритет позволяет изменять приоритеты в процессе работы ЭВМ. Для этого используются два механизма:
* Порог прерывания
* Маска прерывания.
*Порог прерывания* — уровень приоритета программы, выполняемой процессор в текущий момент времени. Определяет минимальный приоритет запросов, в котором разрешается прерывать текущую программу. Специальная схема сравнивает с порогом приоритета запросов все текущие запросы и разрешает только те, приоритет которых выше порогового. Порог прерывания может изменяться специальной командой в регистре контроллера прерываний.
*Маска прерывания* — двоичный код, разряды которого поставлены в соответствии с запросов или классом прерываний и выполнение соотв-их запросов обычно разрешается наличием единицы в разряде маски. Изменяя код маски, можно включать или выключать различные прерывания.
Схема маскировки прерываний имеет следующий вид:

(рис. 3)[]

Каждый разряд регистра маски РгМ при помощи конъюнктора маскирует или активирует соответствующий разряд РгЗП, после чего сигналы со всех конъюнкторов поступают на *схему выделения незамаскированного запроса старшего приоритета* СВНЗСП. Часто СВНЗСП включает в себя схему разделения запросов на классы, поэтому на её выходе генерируется ОСП и *сигнал класса приоритетного прерывающего запроса* КППЗ. Замаскированное прерывание либо игнорируется, либо запоминается. Каждая программа имеет свой код маски, который может изменяться в процессе выполнения. Единица в коде маски текущей программы определяет, какие запросы имеют право прерывать эту программу.


